<!-- templates/admin/login.html -->
{% extends "admin/login.html" %}
{% load i18n static %}

{% block extrastyle %}
{{ block.super }}
<style>
/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å Django */
#header .theme-toggle {
    display: block !important;
    position: absolute !important;
    right: 20px !important;
    top: 15px !important;
    z-index: 1000 !important;
    margin: 0 !important;
}

/* –û—Ç–æ–¥–≤–∏–≥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–ª–µ–≤–æ */
#branding {
    padding-right: 60px !important;
    position: relative;
}

/* –£–±–∏—Ä–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–∫—Ä—ã—Ç—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
.theme-toggle:not(#header .theme-toggle) {
    display: none !important;
}
</style>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script>
// –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å Django
document.addEventListener('DOMContentLoaded', function() {
    console.log('=== ACTIVATING EXISTING DJANGO THEME TOGGLE ===');
    
    // 1. –ù–∞—Ö–æ–¥–∏–º –í–°–ï —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
    const allToggles = document.querySelectorAll('.theme-toggle');
    console.log('Found', allToggles.length, 'theme toggles');
    
    // 2. –ë–µ—Ä—ë–º –ø–µ—Ä–≤—ã–π –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ–º –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫
    if (allToggles.length > 0) {
        const toggle = allToggles[0];
        const header = document.querySelector('#header');
        
        if (header) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
            toggle.style.cssText = `
                display: block !important;
                position: absolute !important;
                right: 20px !important;
                top: 15px !important;
                z-index: 1000 !important;
                margin: 0 !important;
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –µ—Å–ª–∏ –µ—â—ë –Ω–µ —Ç–∞–º
            if (!header.contains(toggle)) {
                header.style.position = 'relative';
                header.appendChild(toggle);
            }
            
            console.log('Django theme toggle activated at:', toggle.style.top, toggle.style.right);
        }
    } else {
        // 3. –ï—Å–ª–∏ Django –Ω–µ —Å–æ–∑–¥–∞–ª –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å, —Å–æ–∑–¥–∞—ë–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π
        console.log('No Django toggle found, creating minimal one');
        
        const toggle = document.createElement('button');
        toggle.className = 'theme-toggle';
        toggle.innerHTML = 'üåô';
        toggle.style.cssText = `
            position: absolute !important;
            right: 20px !important;
            top: 15px !important;
            z-index: 1000 !important;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            padding: 5px;
        `;
        
        toggle.onclick = function() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme') || 'auto';
            const next = current === 'dark' ? 'light' : current === 'light' ? 'auto' : 'dark';
            
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            toggle.textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        };
        
        const header = document.querySelector('#header');
        if (header) {
            header.style.position = 'relative';
            header.appendChild(toggle);
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É
            const saved = localStorage.getItem('theme');
            if (saved) {
                document.documentElement.setAttribute('data-theme', saved);
                toggle.textContent = saved === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            }
        }
    }
    
    // 4. –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ (–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω)
    setTimeout(() => {
        const toggles = document.querySelectorAll('.theme-toggle');
        if (toggles.length > 1) {
            console.log('Removing duplicate toggles:', toggles.length - 1);
            for (let i = 1; i < toggles.length; i++) {
                toggles[i].remove();
            }
        }
    }, 100);
});
</script>
{% endblock %}